<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>R Interface to the Google Cloud Machine Learning Platform • cloudml</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Cloud ML interface for R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Guides
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/guides-training.html">Training</a>
    </li>
    <li>
      <a href="articles/guides-jobs.html">Jobs</a>
    </li>
    <li>
      <a href="articles/guides-tuning.html">Tuning</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Examples
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/examples-mnist.html">MNIST</a>
    </li>
    <li>
      <a href="articles/examples-keras.html">Keras</a>
    </li>
  </ul>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rstudio/cloudml">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">

<p>The <strong>cloudml</strong> package provides an R interface to <a href="https://cloud.google.com/ml-engine/">Google Cloud Machine Learning</a>. <strong>cloudml</strong> makes it easy to take machine learning applications built with R packages like <a href="https://tensorflow.rstudio.com/">tensorflow</a>, <a href="https://keras.rstudio.com/">Keras</a>, and <a href="https://tensorflow.rstudio.com/tfestimators/">tfestimators</a>, and use Google Cloud’s machine learning platform for training, testing, and prediction.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>To get started, install the cloudml R package from GitHub as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"rstudio/cloudml"</span>)</code></pre></div>
</div>
<div id="configuration" class="section level2">
<h2 class="hasAnchor">
<a href="#configuration" class="anchor"></a>Configuration</h2>
<p>Before training in Google Cloud, one needs to configure: tools, projects, authentication and configuration files; which this section describes in detail.</p>
<div id="tools" class="section level3">
<h3 class="hasAnchor">
<a href="#tools" class="anchor"></a>Tools</h3>
<p>The <strong>cloudml</strong> package makes use of the <a href="https://cloud.google.com/sdk/">Google Cloud SDK</a> for communication with Google Cloud Machine Learning. This SDK can be download and installed by following the instructions from <a href="https://cloud.google.com/sdk/downloads">cloud.google.com/sdk/downloads</a>.</p>
</div>
<div id="projects" class="section level3">
<h3 class="hasAnchor">
<a href="#projects" class="anchor"></a>Projects</h3>
<p>Before using the <strong>cloudml</strong> package, you’ll need to make sure you’re set up with an account and project on Google Cloud. Each <strong>cloudml</strong> application needs to be associated with a Google Cloud project and account. If you haven’t already, you can <a href="https://console.cloud.google.com">create an account</a> following the instructions online, and then <a href="https://cloud.google.com/resource-manager/docs/creating-managing-projects">create a project</a> after that. You’ll also want to provision a <a href="https://cloud.google.com/storage/docs/creating-buckets">bucket</a>, to be used as a storage space for applications trained in the cloud.</p>
</div>
<div id="authentication" class="section level3">
<h3 class="hasAnchor">
<a href="#authentication" class="anchor"></a>Authentication</h3>
<p>After creating your account, you’ll need to set up default application credentials to ensure that the Google Cloud SDK can securely communicate with Google and take actions with your project. Try running</p>
<pre><code>gcloud auth application-default login</code></pre>
<p>from a terminal, to request these credentials.</p>
</div>
<div id="configuration-files" class="section level3">
<h3 class="hasAnchor">
<a href="#configuration-files" class="anchor"></a>Configuration Files</h3>
<p>Application deployment is configured through the use of a top-level <a href="http://yaml.org/">YAML</a> file called <code>cloudml.yml</code>. To create a default configuration file run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(cloudml)
<span class="kw">cloudml_create_config</span>()</code></pre></div>
<p>Then modify this default file with the appropiate <code>project</code>, <code>account</code>, <code>region</code> and <code>sotage</code>:</p>
<div class="sourceCode"><pre class="sourceCode yml"><code class="sourceCode yaml"><span class="fu">gcloud:</span>
  <span class="fu">project         :</span><span class="at"> </span><span class="st">"project-name"</span>
  <span class="fu">account         :</span><span class="at"> </span><span class="st">"account@domain.com"</span>
  <span class="fu">region          :</span><span class="at"> </span><span class="st">"us-central1"</span>
  <span class="fu">runtime-version :</span><span class="at"> </span><span class="st">"1.2"</span>

<span class="fu">cloudml:</span>
  <span class="fu">storage         :</span><span class="at"> </span><span class="st">"gs://project-name/mnist"</span></code></pre></div>
<p>The <code>gcloud</code> key is used for configuration specific to the Google Cloud SDK, and so contains items relevant to how applications are deployed.</p>
<ul>
<li><p>Any deployments made will be associated with the <code>project</code> and <code>account</code> fields above,</p></li>
<li><p>Instances provisioned for training will be launched in the region specified by <code>region</code>,</p></li>
<li><p>The TensorFlow version to be used during training is configured using the <code>runtime-version</code> field.</p></li>
</ul>
<p>The <code>storage</code> field in the <code>cloudml</code> section indicates where various artefacts used during provisioning and training are stored. Some useful paths to know:</p>
<ul>
<li><p><code>&lt;storage&gt;/staging</code>: applications will be ‘staged’ in this directory; that is, your deployed application will be uploaded and built in this location;</p></li>
<li><p><code>&lt;storage&gt;/runs/&lt;timestamp&gt;</code>: training outputs will be copied to this directory.</p></li>
</ul>
</div>
</div>
<div id="training" class="section level2">
<h2 class="hasAnchor">
<a href="#training" class="anchor"></a>Training</h2>
<p>We’ll use the <a href="https://github.com/rstudio/cloudml/tree/master/inst/examples/mnist/train.R">MNIST example</a> as we walk through the steps needed to get set up with Google Cloud. We use this application to build a model that classifies digits from the MNIST Dataset.</p>
<p>If you’ve followed these steps, your application should now be ready to be trainned in Google Cloud.</p>
<p>You can train your application with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">job &lt;-<span class="st"> </span><span class="kw"><a href="reference/cloudml_train.html">cloudml_train</a></span>()</code></pre></div>
<p>This function will submit your application to Google Cloud, and request that it train your application by sourcing the training script <code>"train.R"</code>.</p>
<p>When using RStudio, a terminal window is used to stream the logs and download the job when it finializes.</p>
<p>When not using RStudio, you can ask the R session to wait for training to complete, and pull the generated models back to your local filesystem with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/job_collect.html">job_collect</a></span>(job)</code></pre></div>
<p>The R session will wait and continue polling Google Cloud until your application has finished running; if the application trained successfully, then the trained models will be copied to disk under the <code>runs</code> directory.</p>
<p>Once the job is collected, you can use <a href="https://tensorflow.rstudio.com/tools/tfruns/">tfruns</a> to view the results of the last run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tfruns)
<span class="kw"><a href="http://www.rdocumentation.org/packages/tfruns/topics/view_run">view_run</a></span>()</code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>License</h2>
<p><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE.html">LICENSE</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>JJ Allaire <br><small class="roles"> Author, maintainer </small> </li>
<li>Kevin Ushey <br><small class="roles"> Author </small> </li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/rstudio/cloudml"><img src="https://travis-ci.org/rstudio/cloudml.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://cran.r-project.org/package=cloudml"><img src="https://www.r-pkg.org/badges/version/cloudml" alt="CRAN_Status_Badge"></a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by JJ Allaire, Kevin Ushey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
